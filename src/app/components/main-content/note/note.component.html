<!-- Einzelne Notiz-Komponente

    Anzeige und Bearbeitung von Notizen
    Farbauswahl
    Label-Verwaltung
    AnhÃ¤nge-Verwaltung -->

<!-- note.component.html -->
<div [style.background-color]="note.color">
    <span>{{ note.isPinned ? 'ðŸ“Œ' : '' }}</span>
    <button (click)="togglePinNote()">Pinnen</button>
    <div *ngIf="isEditing">
        <input type="text" [(ngModel)]="note.title" placeholder="Title">
        <div *ngIf="!note.isChecklist">
            <input type="text" [(ngModel)]="note.content" placeholder="Note">
        </div>
        <div *ngIf="note.isChecklist">
            <div *ngFor="let item of note.checklistItems; let i = index">
                <input type="text" [(ngModel)]="note.checklistItems[i].text" placeholder="Checklist Item">
                <input type="checkbox" [(ngModel)]="note.checklistItems[i].checked">
                <button (click)="removeChecklistItem(i)">Remove</button>
            </div>
            <button (click)="addChecklistItem()">Add Checklist Item</button>
        </div>
        <button (click)="saveNote()">Speichern</button>
    </div>
    <div *ngIf="!isEditing">
        <h3>{{ note.title }} </h3>
        <p *ngIf="!note.isChecklist">{{ note.content }}</p>
        <ng-container *ngIf="note.isChecklist">
            <ul cdkDropList (cdkDropListDropped)="onDrop($event, false)">
                <li *ngFor="let item of uncheckedItems; let i = index" cdkDrag>
                    <div class="drag-handle">â‹®</div>
                    <input type="checkbox" [(ngModel)]="item.checked" (change)="onCheckboxChange(i, false)">
                    <span>{{ item.text }}</span>
                </li>
            </ul>
            <div *ngIf="checkedItems.length > 0" class="completed-items">
                <button (click)="toggleCompletedItems()" class="toggle-button">
                    {{ isCompletedItemsVisible ? 'â–¼' : 'â–¶' }}
                </button>
                {{ checkedItems.length }} Abgeschlossene {{ checkedItems.length === 1 ? 'Element' : 'Elemente' }}
            </div>
            <ul *ngIf="isCompletedItemsVisible" cdkDropList (cdkDropListDropped)="onDrop($event, true)">
                <li *ngFor="let item of checkedItems; let i = index" cdkDrag>
                    <div class="drag-handle">â‹®</div>
                    <input type="checkbox" [(ngModel)]="item.checked" (change)="onCheckboxChange(i, true)">
                    <span class="completed">{{ item.text }}</span>
                </li>
            </ul>
        </ng-container>
        <button (click)="editNote()">Bearbeiten</button>
    </div>
    <div>
        <select [(ngModel)]="note.color" (change)="changeColor(note.color)">
            <option value="">Default</option>
            <option value="#ffcccb">Red</option>
            <option value="#90ee90">Green</option>
            <option value="#add8e6">Blue</option>
            <option value="#ffffe0">Yellow</option>
        </select>
    </div>
    <button (click)="saveNote()">Speichern</button>
    <p>Erstellt am: {{ note.createdAt | date:'medium' }}</p>
    <div *ngIf="note.attachments.length > 0">
        <h4>AnhÃ¤nge:</h4>
        <ul>
            <li *ngFor="let attachment of note.attachments; let i = index">
                {{ attachment }}
                <button (click)="removeAttachment(i)">Entfernen</button>
            </li>
        </ul>
    </div>
</div>